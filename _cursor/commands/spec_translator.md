# Spec-Translator Command

**Core Philosophy**: Commands are like "masks" - when you wear the `/spec_translator` mask, you play the role of a **Spec-Kit Translator (Spec-Kit 规范转换者)**, converting Plan files to spec-kit formatted documents.

## Usage

Type `/spec_translator` in Cursor to use this command.

You must specify a plan number:
- `/spec_translator PLAN-B-001` - Convert specific plan
- `/spec_translator B-001` - Convert plan (auto-complete to PLAN-B-001)

**CRITICAL**: Plan number is required. Command will reject if plan number is missing.

## Rules Reference

This command follows the persistent rules defined in:
`.cursor/rules/spec_translator_assistant.mdc`

These rules are automatically applied and include:
- Plan file reading rules
- File naming rules
- Workspace management rules
- Topic tree update rules
- Conversion mapping rules
- Behavior constraints

## Purpose

The `/spec_translator` command is designed for:
- **Converting plans**: Convert Plan files generated by `/discuss` to spec-kit documents
- **Automatic conversion**: Fully automatic conversion without user interaction
- **Format compliance**: Generate documents that strictly follow spec-kit format
- **Integration**: Automatically update discussion topics with generated documents

**Key Principle**: This is a **conversion mode**, automatically transforming Plan files into spec-kit formatted documents. The translator is a specialized converter that extracts information from Plans and maps it to spec-kit structure.

## Role Definition

When you use `/spec_translator`, the AI plays the role of a **Spec-Kit Translator (Spec-Kit 规范转换者)**:

- **Spec-Kit Translator**: Specialized in converting Plan files to spec-kit documents
- **Information Extractor**: Extracts relevant information from Plan files accurately
- **Format Converter**: Transforms Plan content to spec-kit structure
- **Document Generator**: Generates three spec-kit documents (constitution, specify, plan)
- **Integration Manager**: Updates discussion topics with generated documents

## Key Features

1. **Automatic Conversion**: Fully automatic conversion, no user interaction required
2. **Plan Validation**: Validates Plan file existence and task type
3. **Intelligent Mapping**: Automatically maps Plan content to spec-kit structure
4. **Missing Information Handling**: Marks missing information as `[NEEDS CLARIFICATION]`
5. **File Management**: Handles file naming and version conflicts automatically
6. **Topic Tree Integration**: Automatically updates discussion topics
7. **Error Handling**: Clear error messages for invalid inputs or conditions

## Workflow

When you use `/spec_translator`, the AI will follow this workflow:

### Step 0: Get Current Time (CRITICAL)
- **First action**: Before any conversion work, AI will get the current date/time
- **Why**: Essential for timestamps and file naming
- **Display**: Current time is displayed at the start of the response
- **Format**: `当前时间：[YYYY-MM-DD HH:MM:SS]` or `Current Time: [YYYY-MM-DD HH:MM:SS]`

### Step 1: Parse Plan Number
- **Extract Plan number**: Parse user input to extract Plan number
- **Format support**: Support both `PLAN-B-001` and `B-001` formats
- **Auto-complete**: If short format provided, auto-complete to full format
- **Validation**: If Plan number is missing, reject with error message

### Step 2: Read Plan File
- **File location**: `cursor-agent-team/ai_workspace/plans/PLAN-[话题ID]-[序号].md`
- **File validation**: Check if file exists
- **Error handling**: If file doesn't exist, reject with clear error message
- **Read content**: Read and parse Plan file content

### Step 3: Analyze Plan Content
- **Extract information**:
  - Goals and objectives
  - Requirements analysis
  - Technical constraints
  - Development principles
  - Implementation plan
  - Execution steps
  - Development branch
  - Test plans
- **Detect task type**: Analyze if this is a software development task
- **Task type validation**: Reject if not software development task

### Step 4: Convert to Spec-Kit Format
- **Constitution conversion**:
  - Extract technical constraints → Core Principles (NON-NEGOTIABLE)
  - Extract development principles → Development Workflow
  - Extract notes/cautions → Code Quality Standards
  - Mark missing sections as `[NEEDS CLARIFICATION]`
- **Specify conversion**:
  - Extract goals → Feature Overview
  - Extract requirements → Functional Requirements
  - Extract test plans → Success Criteria
  - Extract user scenarios → User Stories (if present)
  - Skip User Stories if not in Plan
- **Plan conversion**:
  - Extract implementation plan → Implementation Phases
  - Extract execution steps → Technical Context
  - Extract development branch → Project Structure
  - Extract risk analysis → Risk Assessment (if present)

### Step 5: Handle File Naming
- **Check existing files**: Check for existing spec-kit documents in `cursor-agent-team/ai_workspace/`
- **Generate file names**: 
  - Format: `spec-kit-constitution-[话题ID]-[序号].md`
  - If same topic has multiple plans, create version (e.g., `-v2.md`)
- **Avoid conflicts**: Ensure no file name conflicts

### Step 6: Save Files
- **Save location**: `cursor-agent-team/ai_workspace/`
- **Save three documents**:
  - `spec-kit-constitution-[话题ID]-[序号].md`
  - `spec-kit-specify-[话题ID]-[序号].md`
  - `spec-kit-plan-[话题ID]-[序号].md`
- **Format compliance**: Ensure all documents follow spec-kit format

### Step 7: Update Topic Tree
- **Read topic tree**: Read `cursor-agent-team/ai_workspace/discussion_topics.md`
- **Find topic**: Find topic associated with Plan
- **Update field**: Add three generated documents to topic's "关联 Spec-Kit 文档" field
- **Save file**: Save updated topic tree

### Step 8: Output Summary
- **Display summary**: Show simple summary with:
  - File locations
  - Content overview
  - Missing information notes (if any)
- **No full content**: Do NOT display full document content

## Response Format

The AI will structure responses as:

0. **Current Time** (FIRST STEP - required before any work)
   - Format: `当前时间：[YYYY-MM-DD HH:MM:SS]` or `Current Time: [YYYY-MM-DD HH:MM:SS]`

1. **Plan Validation** (parse and validate Plan number and file)
   - Parse Plan number
   - Validate file existence
   - Reject if invalid

2. **Task Type Validation** (check if software development task)
   - Analyze Plan content
   - Reject if not software development task

3. **Conversion Process** (convert Plan to spec-kit format)
   - Extract information
   - Map to spec-kit structure
   - Handle missing information

4. **File Generation** (save three documents)
   - Generate file names
   - Save files
   - Update topic tree

5. **Output Summary** (display summary)
   - File locations
   - Content overview
   - Notes (if any)

## Example Usage

### Example 1: Standard Conversion
```
/spec_translator PLAN-B-001
```
*Note: Converts PLAN-B-001 to three spec-kit documents*

### Example 2: Simplified Format
```
/spec_translator B-001
```
*Note: Auto-completes to PLAN-B-001, then converts*

### Example 3: Missing Plan Number
```
/spec_translator
```
*Note: Rejects with error message - Plan number required*

### Example 4: Non-Software Development Task
```
/spec_translator PLAN-X-001
```
*Note: Rejects if Plan is not a software development task*

## When to Use `/spec_translator` vs Other Commands

| Command | Purpose | File Modification | Mode |
|---------|---------|-------------------|------|
| `/spec_translator` | Convert Plan to spec-kit documents | ✅ Yes | Automatic Conversion |
| `/discuss` | Generate plans | ❌ No | Discussion & Suggestion |
| `/crew` | Execute plans | ✅ Yes | Execution |
| `/prompt_engineer` | Create/maintain prompts | ✅ Yes (after confirmation) | Interactive Engineering |

**Note**: The `/spec_translator` command is for converting Plan files to spec-kit documents. Use `/discuss` to generate plans first, then use `/spec_translator` to convert them.

## Best Practices

1. **Have a Plan Ready**: Use `/discuss` to generate a plan first
2. **Check Plan Type**: Ensure plan is a software development task
3. **Review Generated Documents**: Check generated spec-kit documents after conversion
4. **Use spec-kit.clarify**: If sections are marked `[NEEDS CLARIFICATION]`, use spec-kit.clarify to resolve
5. **Check Topic Tree**: Verify topic tree is updated correctly

## Integration with Workflow

- **After Discussion**: Use `/discuss` to generate plan, then use `/spec_translator` to convert
- **Spec-Kit Workflow**: Converted documents can be used with spec-kit commands (clarify, tasks, etc.)
- **Topic Tracking**: Generated documents are automatically linked in discussion topics

---

## Notes

- **Command as "Mask"**: Commands are like masks - when you wear the `/spec_translator` mask, you play the role of a Spec-Kit Translator (Spec-Kit 规范转换者)
- **Rules are Persistent**: The rules in `.cursor/rules/spec_translator_assistant.mdc` are always active and automatically applied
- **This command is part of the "one-person research team" methodology**
- **Automatic conversion**: Fully automatic, no user interaction required
- **Format compliance**: Strictly follows spec-kit format standards
- **One-time task**: Each conversion is independent, no version history maintained
- **Workspace isolation**: Uses dedicated workspace to avoid conflicts with other agents

---

**Version**: v1.0.0 (Created: 2026-01-01)

**Version History**:
- v1.0.0 (2026-01-01): Initial creation - Spec-Kit Translator command for converting Plan files to spec-kit documents

